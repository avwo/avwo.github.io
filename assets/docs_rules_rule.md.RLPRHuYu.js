import{_ as t,c as e,o as s,ag as n}from"./chunks/framework.Bw-5EFTY.js";const g=JSON.parse('{"title":"规则语法","description":"","frontmatter":{},"headers":[],"relativePath":"docs/rules/rule.md","filePath":"docs/rules/rule.md"}'),l={name:"docs/rules/rule.md"};function p(i,a,o,r,c,d){return s(),e("div",null,a[0]||(a[0]=[n(`<h1 id="规则语法" tabindex="-1">规则语法 <a class="header-anchor" href="#规则语法" aria-label="Permalink to &quot;规则语法&quot;">​</a></h1><p>Whistle 通过简洁的规则配置来修改请求和响应，每条规则都遵循相同的基础语法结构。</p><h2 id="语法结构" tabindex="-1">语法结构 <a class="header-anchor" href="#语法结构" aria-label="Permalink to &quot;语法结构&quot;">​</a></h2><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern operation [lineProps...] [filters...]</span></span></code></pre></div><p>每条规则由以下四部分组成：</p><table tabindex="0"><thead><tr><th style="text-align:left;">组成部分</th><th style="text-align:left;">是否必填</th><th style="text-align:left;">描述</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>pattern</strong></td><td style="text-align:left;">是</td><td style="text-align:left;">匹配请求 URL 的表达式，详细文档：<a href="./pattern.html">pattern</a></td></tr><tr><td style="text-align:left;"><strong>operation</strong></td><td style="text-align:left;">是</td><td style="text-align:left;">操作指令，格式为 <code>protocol://value</code>，详细文档：<a href="./operation.html">operation</a></td></tr><tr><td style="text-align:left;"><strong>lineProps</strong></td><td style="text-align:left;">否</td><td style="text-align:left;">附加配置，仅对当前规则生效，详细文档：<a href="./lineProps.html">lineProps</a></td></tr><tr><td style="text-align:left;"><strong>filters</strong></td><td style="text-align:left;">否</td><td style="text-align:left;">过滤条件，用于精确控制规则生效场景，详细文档：<a href="./filters.html">filters</a></td></tr></tbody></table><h2 id="规则高级配置" tabindex="-1">规则高级配置 <a class="header-anchor" href="#规则高级配置" aria-label="Permalink to &quot;规则高级配置&quot;">​</a></h2><h3 id="_1-组合配置" tabindex="-1">1. 组合配置 <a class="header-anchor" href="#_1-组合配置" aria-label="Permalink to &quot;1. 组合配置&quot;">​</a></h3><p>单条规则可以包含多个操作指令，实现复杂的功能组合。</p><p><strong>语法</strong>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern operation1 operation2 ... [includeFilter://pattern1 ... excludeFilter://patternN ...]</span></span></code></pre></div><p><strong>示例</strong>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/* file:///static-files cache://3600 resCors://*</span></span></code></pre></div><p><strong>说明</strong>：</p><ul><li>多个操作指令按顺序执行</li><li>支持任意数量的操作指令组合</li><li>过滤器条件对整条规则生效</li></ul><h3 id="_2-位置调换" tabindex="-1">2. 位置调换 <a class="header-anchor" href="#_2-位置调换" aria-label="Permalink to &quot;2. 位置调换&quot;">​</a></h3><p>当 <code>operation</code> 和第一个 <code>pattern</code> 不同时为 URL 或域名格式时，可以调换位置。</p><p><strong>语法</strong>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>operation pattern1 pattern2 ... [includeFilter://pattern1 ... excludeFilter://patternN ...]</span></span></code></pre></div><p><strong>示例</strong>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># 标准写法</span></span>
<span class="line"><span>www.example.com proxy://127.0.0.1:8080</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 位置调换写法</span></span>
<span class="line"><span>proxy://127.0.0.1:8080 www.example.com api.example.com</span></span></code></pre></div><blockquote><p><strong>限制条件</strong>：<code>operation</code> 和第一个 <code>pattern</code> 不能同时为以下格式：</p><ul><li><code>https://test.com/path</code></li><li><code>//test.com/path</code></li><li><code>test.com/path</code></li><li><code>test.com</code></li></ul></blockquote><p><strong>适用场景</strong>：</p><ul><li>为多个域名应用相同操作时更简洁</li><li>批量配置代理、重定向等规则</li></ul><h3 id="_3-换行配置" tabindex="-1">3. 换行配置 <a class="header-anchor" href="#_3-换行配置" aria-label="Permalink to &quot;3. 换行配置&quot;">​</a></h3><p>使用代码块实现多行配置，提高复杂规则的可读性。</p><p><strong>语法</strong>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>line\`</span></span>
<span class="line"><span>operation</span></span>
<span class="line"><span>pattern1</span></span>
<span class="line"><span>pattern2</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>[includeFilter://pattern1</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>excludeFilter://patternN </span></span>
<span class="line"><span>...]</span></span>
<span class="line"><span>\`</span></span></code></pre></div><p><strong>示例</strong>：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>line\`</span></span>
<span class="line"><span>proxy://127.0.0.1:8080</span></span>
<span class="line"><span>www.example.com</span></span>
<span class="line"><span>api.example.com</span></span>
<span class="line"><span>static.example.com</span></span>
<span class="line"><span>includeFilter://m:GET</span></span>
<span class="line"><span>excludeFilter:///admin/</span></span>
<span class="line"><span>\`</span></span></code></pre></div><p><strong>特性</strong>：</p><ul><li>Whistle 会自动将代码块内的换行符替换为空格</li><li>保持代码格式整洁，便于阅读和维护</li><li>适合包含多个匹配模式和复杂过滤条件的场景</li></ul><p><strong>等价转换</strong>： 上述换行配置等价于：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>proxy://127.0.0.1:8080 www.example.com api.example.com static.example.com includeFilter://m:GET excludeFilter:///admin/</span></span></code></pre></div><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><h3 id="_1-规则优先级" tabindex="-1">1. 规则优先级 <a class="header-anchor" href="#_1-规则优先级" aria-label="Permalink to &quot;1. 规则优先级&quot;">​</a></h3><ul><li>规则按从上到下的顺序执行</li><li>后面规则可能覆盖前面规则的效果</li><li>使用 <code>lineProps://important</code> 提升重要规则优先级</li></ul><h3 id="_2-调试技巧" tabindex="-1">2. 调试技巧 <a class="header-anchor" href="#_2-调试技巧" aria-label="Permalink to &quot;2. 调试技巧&quot;">​</a></h3><ol><li><strong>逐步验证</strong>：从简单规则开始，逐步添加复杂条件</li><li><strong>日志查看</strong>：使用 Whistle Network 界面的 Overview 面板查看规则匹配情况</li><li><strong>浏览器调试</strong>：配合浏览器开发者工具检查实际效果</li><li><strong>临时禁用</strong>：使用 <code>#</code> 注释暂时禁用规则进行测试</li></ol>`,39)]))}const u=t(l,[["render",p]]);export{g as __pageData,u as default};
