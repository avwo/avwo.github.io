import{_ as s,c as e,o as t,ag as n}from"./chunks/framework.Bw-5EFTY.js";const u=JSON.parse('{"title":"auth","description":"","frontmatter":{},"headers":[],"relativePath":"docs/rules/auth.md","filePath":"docs/rules/auth.md"}'),i={name:"docs/rules/auth.md"};function p(l,a,o,d,c,h){return t(),e("div",null,a[0]||(a[0]=[n(`<h1 id="auth" tabindex="-1">auth <a class="header-anchor" href="#auth" aria-label="Permalink to &quot;auth&quot;">​</a></h1><p><code>auth</code> 协议用于快速修改请求头的 <code>Authorization</code> 字段，为匹配的请求自动添加 HTTP 基本认证（Basic Authentication）所需的凭证信息。</p><h2 id="规则语法" tabindex="-1">规则语法 <a class="header-anchor" href="#规则语法" aria-label="Permalink to &quot;规则语法&quot;">​</a></h2><p><code>auth</code> 支持多种方式设置请求鉴权头：</p><h3 id="_1-内联值-直接指定" tabindex="-1">1. 内联值（直接指定） <a class="header-anchor" href="#_1-内联值-直接指定" aria-label="Permalink to &quot;1. 内联值（直接指定）&quot;">​</a></h3><p>直接在规则中写明用户名和密码。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern auth://username:password [lineProps...] [filters...]</span></span>
<span class="line"><span># 或</span></span>
<span class="line"><span>pattern auth://username=test&amp;password=123 [lineProps...] [filters...]</span></span></code></pre></div><p><strong>示例：</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/api1/ auth://admin:secret</span></span>
<span class="line"><span>https://example.com/api2/ auth://username=admin&amp;password=secret</span></span></code></pre></div><h3 id="_2-内嵌值-使用代码块" tabindex="-1">2. 内嵌值（使用代码块） <a class="header-anchor" href="#_2-内嵌值-使用代码块" aria-label="Permalink to &quot;2. 内嵌值（使用代码块）&quot;">​</a></h3><p>当凭证信息较复杂或需要复用时可使用此方式。在规则中引用一个自定义键，并在随后的代码块中定义其值。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern auth://{custom-key} [lineProps...] [filters...]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` custom-key</span></span>
<span class="line"><span>username: admin</span></span>
<span class="line"><span>password: my secret password</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="_3-引用-values-中的值" tabindex="-1">3. 引用 Values 中的值 <a class="header-anchor" href="#_3-引用-values-中的值" aria-label="Permalink to &quot;3. 引用 Values 中的值&quot;">​</a></h3><p>引用在界面 <code>Values</code> 中预先定义好的值。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern auth://{key-of-values} [lineProps...] [filters...]</span></span></code></pre></div><p><strong>前提：</strong> 在 <code>Values</code> 中存在一个名为 <code>key-of-values</code> 的键，其值为包含用户名和密码的对象。</p><h3 id="_4-从临时文件中加载" tabindex="-1">4. 从临时文件中加载 <a class="header-anchor" href="#_4-从临时文件中加载" aria-label="Permalink to &quot;4. 从临时文件中加载&quot;">​</a></h3><p>当需要频繁编辑内容时，可以使用 Whistle 提供的临时文件功能。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern auth://temp.json</span></span></code></pre></div><p><strong>操作步骤</strong>：</p><ol><li>在 Rules 编辑器中，按住 <code>Command</code>（Mac）/ <code>Ctrl</code>（Windows）</li><li>鼠标点击 <code>auth://temp.json</code></li><li>在弹出的编辑对话框中输入响应内容</li><li>点击 <code>Save</code> 保存</li></ol><p>保存后规则会自动变为类似以下格式：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/report auth://temp/11adb9c9e1142df67b30d7646ec59bcd34c855d9011d1a2405c7fc2dfc94568d.json</span></span></code></pre></div><p>需要再次编辑时，用同样的方式点击该临时文件链接即可。</p><h3 id="_5-从文件或远程-url-加载" tabindex="-1">5. 从文件或远程 URL 加载 <a class="header-anchor" href="#_5-从文件或远程-url-加载" aria-label="Permalink to &quot;5. 从文件或远程 URL 加载&quot;">​</a></h3><p>从本地文件或远程 URL 加载包含鉴权信息的 JSON 或简单 YAML 文件。</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># 从本地文件加载</span></span>
<span class="line"><span>pattern auth:///User/xxx/auth.json</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 从远程 URL 加载（支持 http 和 https）</span></span>
<span class="line"><span>pattern auth://https://config.example.com/auth.json</span></span></code></pre></div><p><strong>文件格式要求：</strong> 文件内容应为 JSON 或简单 YAML 格式，包含 <code>username</code> 和 <code>password</code> 字段：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;username&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;admin&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;secret&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>或</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">username</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">admin</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">password</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">secret</span></span></code></pre></div><h2 id="参数详解" tabindex="-1">参数详解 <a class="header-anchor" href="#参数详解" aria-label="Permalink to &quot;参数详解&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">参数</th><th style="text-align:left;">是否必填</th><th style="text-align:left;">描述与示例</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>pattern</strong></td><td style="text-align:left;">是</td><td style="text-align:left;">用于匹配请求 URL 的表达式。<br>• 支持域名、路径、通配符、正则表达式。<br>• 详见 <a href="./pattern.html">匹配模式文档</a>。</td></tr><tr><td style="text-align:left;"><strong>value</strong></td><td style="text-align:left;">是</td><td style="text-align:left;">鉴权凭证信息，支持多种格式：<br>• <strong>直接格式</strong>：<code>username:password</code> 或 <code>username=test&amp;password=123</code><br>• <strong>对象格式</strong>：包含 <code>username</code> 和 <code>password</code> 字段的对象<br>• 支持从本地文件或远程 URL 加载<br>• 支持内联、内嵌、Values、本地文件路径、远程 URL 引用</td></tr><tr><td style="text-align:left;"><strong>lineProps</strong></td><td style="text-align:left;">否</td><td style="text-align:left;">为规则设置附加属性。<br>• 例如：<code>lineProps://important</code> 可提升此规则的优先级。<br>• 详见 <a href="./lineProps.html">lineProps 文档</a>。</td></tr><tr><td style="text-align:left;"><strong>filters</strong></td><td style="text-align:left;">否</td><td style="text-align:left;">可选的过滤条件，用于精确控制规则生效的场景。<br>• 可匹配请求的 URL、方法、头部、体内容。<br>• 可匹配响应的状态码、头部。<br>• 详见 <a href="./filters.html">过滤器文档</a>。</td></tr></tbody></table><h2 id="配置示例" tabindex="-1">配置示例 <a class="header-anchor" href="#配置示例" aria-label="Permalink to &quot;配置示例&quot;">​</a></h2><h3 id="基础示例" tabindex="-1">基础示例 <a class="header-anchor" href="#基础示例" aria-label="Permalink to &quot;基础示例&quot;">​</a></h3><p>为 example.com 的 API 接口添加基本认证：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://api.example.com/ auth://admin:secret</span></span></code></pre></div><h3 id="使用内嵌值" tabindex="-1">使用内嵌值 <a class="header-anchor" href="#使用内嵌值" aria-label="Permalink to &quot;使用内嵌值&quot;">​</a></h3><p>当密码包含特殊字符或空格时，使用内嵌方式更安全：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://internal.example.com/ auth://{prod-credentials}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` prod-credentials</span></span>
<span class="line"><span>username: service-account</span></span>
<span class="line"><span>password: P@ssw0rd!2024</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="从文件加载" tabindex="-1">从文件加载 <a class="header-anchor" href="#从文件加载" aria-label="Permalink to &quot;从文件加载&quot;">​</a></h3><p>从本地配置文件加载鉴权信息：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/api/ auth:///Users/john/config/auth.json</span></span></code></pre></div><h3 id="配合过滤器使用" tabindex="-1">配合过滤器使用 <a class="header-anchor" href="#配合过滤器使用" aria-label="Permalink to &quot;配合过滤器使用&quot;">​</a></h3><p>仅对 POST 请求添加鉴权：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/api/ auth://admin:secret includeFilter://m:POST</span></span></code></pre></div><h3 id="引用-values-中的配置" tabindex="-1">引用 Values 中的配置 <a class="header-anchor" href="#引用-values-中的配置" aria-label="Permalink to &quot;引用 Values 中的配置&quot;">​</a></h3><p>假设在 Values 中已有 <code>api-auth</code> 配置：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/api/ auth://{api-auth}</span></span></code></pre></div><h2 id="工作原理与关联协议" tabindex="-1">工作原理与关联协议 <a class="header-anchor" href="#工作原理与关联协议" aria-label="Permalink to &quot;工作原理与关联协议&quot;">​</a></h2><ol><li><p><strong>核心原理</strong>：<code>auth</code> 协议会自动计算用户名和密码的 Base64 编码，并设置 <code>Authorization</code> 请求头。</p><p>上面的示例等价于使用 <a href="./reqHeaders.html"><code>reqHeaders</code></a> 协议手动设置：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/api/ reqHeaders://{auth.txt} # 内容有空格，不能内联</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` auth.txt</span></span>
<span class="line"><span>authorization: Basic YWRtaW46c2VjcmV0</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><p>其中 <code>YWRtaW46c2VjcmV0</code> 是 <code>admin:secret</code> 的 Base64 编码。</p></li><li><p><strong>优势</strong>：相比于直接使用 <code>reqHeaders</code>，<code>auth</code> 语法更简洁直观，无需手动计算 Base64 编码值。</p></li></ol><h2 id="注意事项" tabindex="-1">注意事项 <a class="header-anchor" href="#注意事项" aria-label="Permalink to &quot;注意事项&quot;">​</a></h2><ul><li><code>auth</code> 协议仅支持 HTTP 基本认证（Basic Authentication）</li><li>对于更复杂的认证方式（如 Bearer Token、OAuth 等），请使用 <a href="./reqHeaders.html"><code>reqHeaders</code></a> 协议直接设置相应的 <code>Authorization</code> 头</li><li>从远程 URL 加载时，请确保目标 URL 安全可靠</li></ul>`,53)]))}const g=s(i,[["render",p]]);export{u as __pageData,g as default};
