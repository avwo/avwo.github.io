import{_ as t,c as o,o as a,ag as l}from"./chunks/framework.Bw-5EFTY.js";const u=JSON.parse('{"title":"规则语法","description":"","frontmatter":{},"headers":[],"relativePath":"docs/rules/rule.md","filePath":"docs/rules/rule.md"}'),s={name:"docs/rules/rule.md"};function i(n,e,c,p,d,r){return a(),o("div",null,e[0]||(e[0]=[l(`<h1 id="规则语法" tabindex="-1">规则语法 <a class="header-anchor" href="#规则语法" aria-label="Permalink to &quot;规则语法&quot;">​</a></h1><p>Whistle 通过简单的规则配置修改请求/响应，基本语法结构如下：</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern operation [includeFilter://pattern1 ... excludeFilter://patternN ...]</span></span></code></pre></div><h2 id="规则组成" tabindex="-1">规则组成 <a class="header-anchor" href="#规则组成" aria-label="Permalink to &quot;规则组成&quot;">​</a></h2><p>每条规则由三个核心部分组成：</p><ol><li><strong>匹配模式</strong> (<code>pattern</code>)，匹配请求 URL 的表达式，支持多种格式： <ul><li>域名匹配：<code>www.test.com</code>（匹配该域名所有请求，含端口）</li><li>路径匹配：<code>www.test.com/path</code></li><li>正则表达式：<code>/^https?://test\\.com//i</code></li><li>通配符：<code>*.test.com</code>、<code>**.test.com/path</code></li></ul><blockquote><p>Whistle 有三种 URL 类型：</p><ol><li><strong>隧道代理：</strong><code>tunnel://domain[:port]</code></li><li><strong>WebSocket：</strong><code>ws[s]://domain[:port]/path/to</code></li><li><strong>普通 HTTP/HTTPS：</strong><code>http[s]://domain[:port]/path/to</code></li></ol></blockquote></li><li><strong>操作指令</strong> (<code>operation</code>)，格式：<code>protocol://value</code><ul><li><code>protocol</code>：操作类型，如： <ul><li><code>reqHeaders</code>：修改请求头</li><li><code>resHeaders</code>：修改响应头</li></ul></li><li><code>value</code>：操作内容，支持多种数据源： <ul><li>内联值：<code>reqHeaders://x-proxy-by=whistle</code>（直接添加请求头）</li><li>本地文件：<code>file://path/to/file</code></li><li>远程资源：<code>https://example.com/data.json</code></li><li>预设变量：<code>{key}</code>（从 Rules 里面的内嵌值 或 Values 读取）</li></ul></li></ul><blockquote><p><strong>operation</strong> 里面的 <code>protocol://</code> 在以下两种场景时可以省略：</p><ul><li><code>ip</code> 或 <code>ip:port</code>：等价于 <code>host://ip</code> 或 <code>host://ip:port</code></li><li><code>D:\\path\\to</code>、<code>/path/to</code> 或 <code>{key}</code>：等价于 <code>file://D:\\path\\to</code>、<code>file:///path/to</code> 或 <code>file://{key}</code></li></ul></blockquote></li><li><strong>过滤条件（可选）</strong> (<code>includeFilter/excludeFilter</code>) <ul><li>逻辑关系：多条件间为「或」匹配，只要匹配其中一个过滤条件就成立</li><li>匹配范围： <ul><li>请求：URL、方法（GET/POST等）、头部字段、内容、客户端 IP</li><li>响应：状态码、头部字段、内容、服务端 IP</li></ul></li></ul></li></ol><h2 id="规则高级配置" tabindex="-1">规则高级配置 <a class="header-anchor" href="#规则高级配置" aria-label="Permalink to &quot;规则高级配置&quot;">​</a></h2><ol><li>组合配置<div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern operation1 operation2 ... [includeFilter://pattern1 ... excludeFilter://patternN ...]</span></span></code></pre></div></li><li>位置调换（<code>pattern1</code> 和 <code>operation</code> 不同时为 URL 或域名） <blockquote><p>即不同时为形如 <code>https://test.com/path</code>、<code>//test.com/path</code>、<code>test.com/path</code>、<code>test.com</code> 的 URL 或域名</p></blockquote><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>operation pattern1 pattern2 ... [includeFilter://pattern1 ... excludeFilter://patternN ...]</span></span></code></pre></div></li><li>换行配置<div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>line\`</span></span>
<span class="line"><span>operation</span></span>
<span class="line"><span>pattern1</span></span>
<span class="line"><span>pattern2</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>[includeFilter://pattern1</span></span>
<span class="line"><span>...</span></span>
<span class="line"><span>excludeFilter://patternN </span></span>
<span class="line"><span>...]</span></span>
<span class="line"><span>\`</span></span></code></pre></div><blockquote><p>Whistle 会自动将代码块里面的换行符自动替换成空格</p></blockquote></li></ol><h2 id="详细内容" tabindex="-1">详细内容 <a class="header-anchor" href="#详细内容" aria-label="Permalink to &quot;详细内容&quot;">​</a></h2><ol><li>匹配模式（匹配请求 URL 的表达式）详解：<a href="./pattern.html">Pattern</a></li><li>操作指令详解：<a href="./operation.html">Operation</a></li><li>过滤器详解：<a href="./filters.html">Filters</a></li></ol>`,10)]))}const g=t(s,[["render",i]]);export{u as __pageData,g as default};
