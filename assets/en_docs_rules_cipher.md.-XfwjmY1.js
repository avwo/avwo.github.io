import{_ as e,c as i,o as a,ag as t}from"./chunks/framework.Bw-5EFTY.js";const k=JSON.parse('{"title":"tlsOptions","description":"","frontmatter":{},"headers":[],"relativePath":"en/docs/rules/cipher.md","filePath":"en/docs/rules/cipher.md"}'),n={name:"en/docs/rules/cipher.md"};function l(p,s,o,r,h,c){return a(),i("div",null,s[0]||(s[0]=[t(`<h1 id="tlsoptions" tabindex="-1">tlsOptions <a class="header-anchor" href="#tlsoptions" aria-label="Permalink to &quot;tlsOptions&quot;">​</a></h1><p>The <code>tlsOptions</code> protocol is used to configure security parameters for HTTPS/TLS connections, including encryption cipher suites, client certificates, etc., to establish encrypted communication channels and server authentication.</p><blockquote><p><strong>Version Requirement</strong>: Only the latest version of Whistle (≥ v2.9.101) supports this feature.</p></blockquote><p>With the <code>tlsOptions</code> protocol, you can:</p><ul><li>Customize TLS encryption cipher suites</li><li>Configure client certificates required for mutual authentication (mTLS)</li><li>Set other security parameters for TLS connections</li><li>Control TLS versions and connection options</li></ul><p><strong>Rule Merging Mechanism</strong>: <code>tlsOptions</code> supports setting any number of configuration rules. Whistle automatically merges these rules in top-to-bottom order, allowing you to flexibly combine different TLS configurations.</p><h2 id="rule-syntax" tabindex="-1">Rule Syntax <a class="header-anchor" href="#rule-syntax" aria-label="Permalink to &quot;Rule Syntax&quot;">​</a></h2><p><code>tlsOptions</code> supports multiple ways to configure security parameters for HTTPS/TLS connections:</p><h3 id="_1-inline-value-direct-specification" tabindex="-1">1. Inline Value (Direct Specification) <a class="header-anchor" href="#_1-inline-value-direct-specification" aria-label="Permalink to &quot;1. Inline Value (Direct Specification)&quot;">​</a></h3><p>Write the operation directly in the rule.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Set client certificate</span></span>
<span class="line"><span>pattern tlsOptions://key=/path/to/client.key&amp;cert=/path/to/client.crt</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Customize cipher suite</span></span>
<span class="line"><span>pattern tlsOptions://ECDHE-ECDSA-AES256-GCM-SHA384:DH-RSA-AES256-GCM-SHA384 [lineProps...] [filters...]</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Or use the ciphers parameter</span></span>
<span class="line"><span>pattern tlsOptions://ciphers=ECDHE-ECDSA-AES256-GCM-SHA384:DH-RSA-AES256-GCM-SHA384 [lineProps...] [filters...]</span></span></code></pre></div><h3 id="_2-embedded-value-using-code-block" tabindex="-1">2. Embedded Value (Using Code Block) <a class="header-anchor" href="#_2-embedded-value-using-code-block" aria-label="Permalink to &quot;2. Embedded Value (Using Code Block)&quot;">​</a></h3><p>Use this method when the configuration is complex or needs to be reused.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern tlsOptions://{custom-key} [lineProps...] [filters...]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` custom-key</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  passphrase: &quot;123456&quot;,</span></span>
<span class="line"><span>  pfx: &quot;-----BEGIN PKCS7-----\\n...&quot;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="_3-referencing-a-value-from-the-values-panel" tabindex="-1">3. Referencing a Value from the Values Panel <a class="header-anchor" href="#_3-referencing-a-value-from-the-values-panel" aria-label="Permalink to &quot;3. Referencing a Value from the Values Panel&quot;">​</a></h3><p>Reference a configuration pre-defined in the <code>Values</code> panel (central configuration area).</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern tlsOptions://{key-of-values} [lineProps...] [filters...]</span></span></code></pre></div><p><strong>Prerequisite:</strong> A key named <code>key-of-values</code> with a TLS configuration object as its value must exist in <code>Values</code>.</p><h3 id="_4-loading-from-a-temporary-file" tabindex="-1">4. Loading from a Temporary File <a class="header-anchor" href="#_4-loading-from-a-temporary-file" aria-label="Permalink to &quot;4. Loading from a Temporary File&quot;">​</a></h3><p>Use Whistle&#39;s temporary file feature when content needs frequent editing.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern tlsOptions://temp.json</span></span></code></pre></div><p><strong>Steps:</strong></p><ol><li>In the Rules editor, hold down <code>Command</code> (Mac) / <code>Ctrl</code> (Windows)</li><li>Click with the mouse on <code>tlsOptions://temp.json</code></li><li>Enter the response content in the pop-up editing dialog</li><li>Click <code>Save</code> to save</li></ol><p>After saving, the rule will automatically change to a format similar to this:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>https://example.com/report tlsOptions://temp/11adb9c9e1142df67b30d7646ec59bcd34c855d9011d1a2405c7fc2dfc94568d.json</span></span></code></pre></div><p>To edit again, click the temporary file link in the same way.</p><h3 id="_5-loading-from-a-file-or-remote-url" tabindex="-1">5. Loading from a File or Remote URL <a class="header-anchor" href="#_5-loading-from-a-file-or-remote-url" aria-label="Permalink to &quot;5. Loading from a File or Remote URL&quot;">​</a></h3><p>Load a JSON or YAML file containing TLS configuration from a local file or remote URL.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Load from a local file</span></span>
<span class="line"><span>pattern tlsOptions:///User/xxx/tlsOptions.json</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Load from a remote URL (supports http and https)</span></span>
<span class="line"><span>pattern tlsOptions://https://config.example.com/tlsOptions.json</span></span></code></pre></div><p><strong>File Format Requirements:</strong> The file content should be in JSON or YAML format:</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;ciphers&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;minVersion&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TLSv1.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;maxVersion&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TLSv1.3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;secureProtocol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TLSv1_2_method&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>or</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">ciphers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">minVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TLSv1.2</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">maxVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TLSv1.3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">secureProtocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">TLSv1_2_method</span></span></code></pre></div><hr><h2 id="parameter-details" tabindex="-1">Parameter Details <a class="header-anchor" href="#parameter-details" aria-label="Permalink to &quot;Parameter Details&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter</th><th style="text-align:left;">Required</th><th style="text-align:left;">Description &amp; Examples</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>pattern</strong></td><td style="text-align:left;">Yes</td><td style="text-align:left;">Expression used to match the request URL.<br>• Supports domains, paths, wildcards, regular expressions.<br>• See <a href="./pattern.html">Matching Pattern Documentation</a> for details.</td></tr><tr><td style="text-align:left;"><strong>value</strong></td><td style="text-align:left;">Yes</td><td style="text-align:left;">TLS configuration data, supporting multiple formats:<br>• Cipher suite names (separated by <code>:</code>)<br>• <code>tls.connect(options)</code> parameter object<br>• Supports references from local files, remote URLs, inline, embedded, and Values</td></tr><tr><td style="text-align:left;"><strong>lineProps</strong></td><td style="text-align:left;">No</td><td style="text-align:left;">Sets additional properties for the rule.<br>• Example: <code>lineProps://important</code> can increase this rule&#39;s priority.<br>• See <a href="./lineProps.html">lineProps Documentation</a> for details.</td></tr><tr><td style="text-align:left;"><strong>filters</strong></td><td style="text-align:left;">No</td><td style="text-align:left;">Optional filter conditions for precise control over when the rule takes effect.<br>• Can match request URL, method, headers, body content.<br>• Can match response status code, headers.<br>• See <a href="./filters.html">Filters Documentation</a> for details.</td></tr></tbody></table><hr><h2 id="configuration-object-reference" tabindex="-1">Configuration Object Reference <a class="header-anchor" href="#configuration-object-reference" aria-label="Permalink to &quot;Configuration Object Reference&quot;">​</a></h2><p>Complete TLS connection configuration object, supporting all parameters of Node.js <a href="https://nodejs.org/docs/latest/api/tls.html#tlscreatesecurecontextoptions" target="_blank" rel="noreferrer"><code>tls.connect()</code></a>:</p><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Encryption cipher suites</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ciphers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // TLS protocol version control</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  minVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TLSv1.2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  maxVersion</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TLSv1.3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  secureProtocol</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;TLSv1_2_method&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Certificate-related configurations</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ca</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-----BEGIN CERTIFICATE-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// CA certificate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  cert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-----BEGIN CERTIFICATE-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Client certificate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  key</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-----BEGIN PRIVATE KEY-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Private key</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  pfx</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-----BEGIN PKCS7-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// PFX/P12 format certificate</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  passphrase</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;cert-password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,             </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Certificate password</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Other security options</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  honorCipherOrder</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Prioritize the server&#39;s cipher suite order</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  requestCert</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Request client certificate (mutual authentication)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  rejectUnauthorized</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Reject unauthorized certificates</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Advanced options</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  ecdhCurve</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;auto&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,         </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ECDH curve</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  dhparam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-----BEGIN DH PARAMETERS-----</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">...&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  secureOptions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// SSL option flags</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  sessionTimeout</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">300</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,       </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Session timeout (seconds)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  sessionIdContext</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;whistle&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><hr><h2 id="configuration-examples" tabindex="-1">Configuration Examples <a class="header-anchor" href="#configuration-examples" aria-label="Permalink to &quot;Configuration Examples&quot;">​</a></h2><h3 id="_1-custom-cipher-suite" tabindex="-1">1. Custom Cipher Suite <a class="header-anchor" href="#_1-custom-cipher-suite" aria-label="Permalink to &quot;1. Custom Cipher Suite&quot;">​</a></h3><p>Restrict TLS encryption algorithms for specific domains:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/path tlsOptions://ECDHE-ECDSA-AES256-GCM-SHA384:DH-RSA-AES256-GCM-SHA384</span></span></code></pre></div><blockquote><p><strong>Use Case</strong>: Solve compatibility issues with specific servers. Reference: <a href="https://github.com/avwo/whistle/issues/963" target="_blank" rel="noreferrer">GitHub Issue #963</a></p></blockquote><h3 id="_2-configuring-client-certificate-mutual-authentication-mtls" tabindex="-1">2. Configuring Client Certificate (Mutual Authentication mTLS) <a class="header-anchor" href="#_2-configuring-client-certificate-mutual-authentication-mtls" aria-label="Permalink to &quot;2. Configuring Client Certificate (Mutual Authentication mTLS)&quot;">​</a></h3><p><strong>cert format certificate:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.exaple.com/path tlsOptions://key=/User/xxx/test.key&amp;cert=/User/xxx/test.crt</span></span></code></pre></div><p><strong>pem format certificate:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.exaple.com/path tlsOptions://key=E:\\test.key&amp;cert=E:\\test.pem</span></span></code></pre></div><p><strong>pfx format certificate:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.exaple.com/path tlsOptions://passphrase=123456&amp;pfx=/User/xxx/test.pfx</span></span></code></pre></div><p><strong>p12 format certificate:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.exaple.com/path tlsOptions://passphrase=123456&amp;pfx=E:/test.p12</span></span></code></pre></div><blockquote><p><strong>Windows Paths</strong>: Supports mixing <code>/</code> and <code>\\</code> as path separators.</p></blockquote><h3 id="_3-embedding-certificate-content" tabindex="-1">3. Embedding Certificate Content <a class="header-anchor" href="#_3-embedding-certificate-content" aria-label="Permalink to &quot;3. Embedding Certificate Content&quot;">​</a></h3><p>Embed certificate content directly into the configuration:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\`\`\` test.json</span></span>
<span class="line"><span>{</span></span>
<span class="line"><span>  key: &#39;----xxx----- ... ----xxx-----&#39;,</span></span>
<span class="line"><span>  cert: &#39;----yyy----- ... ----yyy-----&#39;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>www.exaple.com/path tlsOptions://{test.json}</span></span></code></pre></div><h3 id="_4-loading-configuration-from-local-or-remote-files" tabindex="-1">4. Loading Configuration from Local or Remote Files <a class="header-anchor" href="#_4-loading-configuration-from-local-or-remote-files" aria-label="Permalink to &quot;4. Loading Configuration from Local or Remote Files&quot;">​</a></h3><p><strong>Load from local file:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/path1 tlsOptions:///User/xxx/test.json</span></span></code></pre></div><p><strong>Load from remote URL:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/path2 tlsOptions://https://www.xxx.com/xxx/params.json</span></span></code></pre></div><p><strong>Use temporary file for editing:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/path3 tlsOptions://temp/blank.json</span></span></code></pre></div><h3 id="_5-rule-merging-example" tabindex="-1">5. Rule Merging Example <a class="header-anchor" href="#_5-rule-merging-example" aria-label="Permalink to &quot;5. Rule Merging Example&quot;">​</a></h3><p>Utilize rule merging feature to gradually refine configuration:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># First layer: Set basic TLS version for the entire domain</span></span>
<span class="line"><span>*.example.com tlsOptions://minVersion=TLSv1.2</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Second layer: Add client certificate for API subdomain</span></span>
<span class="line"><span>api.example.com tlsOptions://key=/certs/client.key&amp;cert=/certs/client.crt</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Third layer: Further restrict cipher suite for specific paths</span></span>
<span class="line"><span>api.example.com/secure/* tlsOptions://ciphers=ECDHE-RSA-AES256-GCM-SHA384</span></span></code></pre></div><hr><h2 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes&quot;">​</a></h2><ol><li><strong>Version Compatibility</strong>: Ensure the Whistle version used is ≥ v2.9.101.</li><li><strong>Certificate Format</strong>: Different certificate formats require corresponding parameters: <ul><li>PEM format: Use <code>key</code> and <code>cert</code> parameters.</li><li>PFX/P12 format: Use <code>pfx</code> and <code>passphrase</code> parameters.</li></ul></li><li><strong>Path Handling</strong>: <ul><li>Relative paths are relative to the Whistle configuration file directory.</li><li>Windows paths can mix <code>/</code> and <code>\\</code>.</li></ul></li><li><strong>Security Warnings</strong>: <ul><li>Use <code>rejectUnauthorized: false</code> with caution, only in development environments.</li><li>Safeguard client private keys to avoid leaks.</li></ul></li><li><strong>Performance Impact</strong>: Complex encryption algorithms may affect connection performance.</li><li><strong>Debugging Recommendations</strong>: When encountering connection issues, test with simple configurations first, then gradually add complex options.</li></ol><hr><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="q-certificate-loading-fails" tabindex="-1">Q: Certificate loading fails. <a class="header-anchor" href="#q-certificate-loading-fails" aria-label="Permalink to &quot;Q: Certificate loading fails.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the certificate file path is correct.</li><li>Whether the certificate format matches the parameter type.</li><li>Whether the PFX certificate password is correct.</li></ol><h3 id="q-connection-is-rejected" tabindex="-1">Q: Connection is rejected. <a class="header-anchor" href="#q-connection-is-rejected" aria-label="Permalink to &quot;Q: Connection is rejected.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the TLS version is supported by the server.</li><li>Whether the cipher suite is supported by the server.</li><li>Whether the client certificate is valid and trusted by the server.</li></ol><h3 id="q-configuration-does-not-take-effect" tabindex="-1">Q: Configuration does not take effect. <a class="header-anchor" href="#q-configuration-does-not-take-effect" aria-label="Permalink to &quot;Q: Configuration does not take effect.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the rule pattern correctly matches the target URL.</li><li>Whether the Whistle version meets requirements.</li><li>Whether the configuration syntax is correct, especially JSON format.</li><li>Whether conflicting rules exist (rules are merged in top-to-bottom order).</li></ol><h3 id="q-rule-merging-doesn-t-work-as-expected" tabindex="-1">Q: Rule merging doesn&#39;t work as expected. <a class="header-anchor" href="#q-rule-merging-doesn-t-work-as-expected" aria-label="Permalink to &quot;Q: Rule merging doesn&#39;t work as expected.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the order of rules is correct (merged from top to bottom).</li><li>Whether configurations in different rules conflict.</li><li>Whether more specific patterns override general configurations.</li></ol>`,86)]))}const g=e(n,[["render",l]]);export{k as __pageData,g as default};
