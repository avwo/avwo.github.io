import{_ as a,c as n,o as s,ag as t}from"./chunks/framework.Bw-5EFTY.js";const u=JSON.parse('{"title":"resPrepend","description":"","frontmatter":{},"headers":[],"relativePath":"en/docs/rules/resPrepend.md","filePath":"en/docs/rules/resPrepend.md"}'),i={name:"en/docs/rules/resPrepend.md"};function o(l,e,p,r,d,c){return s(),n("div",null,e[0]||(e[0]=[t(`<h1 id="resprepend" tabindex="-1">resPrepend <a class="header-anchor" href="#resprepend" aria-label="Permalink to &quot;resPrepend&quot;">​</a></h1><p>The <code>resPrepend</code> protocol is used to insert specified content at the beginning of an existing response body. It only takes effect on status codes that include a response body (such as <code>200</code>, <code>500</code>, etc.). Through the <code>resPrepend</code> protocol, you can:</p><ul><li>Add custom content at the beginning of a response.</li><li>Insert debugging information or timestamps.</li><li>Add references to scripts, stylesheets, or other resources.</li><li>Inject environment markers or version information.</li><li>Keep the original response content intact, adding extra content only at the beginning.</li></ul><blockquote><p><strong>Effective Condition</strong>: Only takes effect on status codes with a response body.</p><p>⚠️ Note: Requests without a response body, such as <code>204</code>, <code>304</code>, are not affected.</p></blockquote><h2 id="rule-syntax" tabindex="-1">Rule Syntax <a class="header-anchor" href="#rule-syntax" aria-label="Permalink to &quot;Rule Syntax&quot;">​</a></h2><p><code>resPrepend</code> supports multiple ways to specify the content to be inserted:</p><h3 id="_1-inline-value-direct-specification" tabindex="-1">1. Inline Value (Direct Specification) <a class="header-anchor" href="#_1-inline-value-direct-specification" aria-label="Permalink to &quot;1. Inline Value (Direct Specification)&quot;">​</a></h3><p>Write the content to insert directly in the rule, suitable for short text (cannot contain spaces or line breaks).</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern resPrepend://(value) [lineProps...] [filters...]</span></span></code></pre></div><p><strong>Example:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/page resPrepend://(&lt;!--Page Start--&gt;)</span></span></code></pre></div><h3 id="_2-embedded-value-using-code-block" tabindex="-1">2. Embedded Value (Using Code Block) <a class="header-anchor" href="#_2-embedded-value-using-code-block" aria-label="Permalink to &quot;2. Embedded Value (Using Code Block)&quot;">​</a></h3><p>This method is recommended when dealing with complex content containing spaces, line breaks, or when you want to reuse a configuration.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern resPrepend://{custom-key} [lineProps...] [filters...]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` custom-key</span></span>
<span class="line"><span>&lt;!-- Debug Info --&gt;</span></span>
<span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>  console.log(&#39;Page Load Time:&#39;, new Date().toISOString());</span></span>
<span class="line"><span>&lt;/script&gt;</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="_3-referencing-a-value-from-the-values-panel" tabindex="-1">3. Referencing a Value from the Values Panel <a class="header-anchor" href="#_3-referencing-a-value-from-the-values-panel" aria-label="Permalink to &quot;3. Referencing a Value from the Values Panel&quot;">​</a></h3><p>When the content is large, you can store it in the <code>Values</code> configuration area.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern resPrepend://{key-of-values} [lineProps...] [filters...]</span></span></code></pre></div><p><strong>Prerequisite</strong>: A key named <code>key-of-values</code> with the content to insert as its value must exist in <code>Values</code>.</p><h3 id="_4-loading-from-a-file-path-or-remote-url" tabindex="-1">4. Loading from a File Path or Remote URL <a class="header-anchor" href="#_4-loading-from-a-file-path-or-remote-url" aria-label="Permalink to &quot;4. Loading from a File Path or Remote URL&quot;">​</a></h3><p>Load the response content to insert from a local file or remote URL.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Load from a local file</span></span>
<span class="line"><span>pattern resPrepend:///User/xxx/header.html</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Load from a remote URL</span></span>
<span class="line"><span>pattern resPrepend://https://cdn.example.com/analytics-script.js</span></span></code></pre></div><h3 id="_5-loading-from-a-temporary-file" tabindex="-1">5. Loading from a Temporary File <a class="header-anchor" href="#_5-loading-from-a-temporary-file" aria-label="Permalink to &quot;5. Loading from a Temporary File&quot;">​</a></h3><p>Use Whistle&#39;s temporary file feature when content needs frequent editing.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern resPrepend://temp/blank.txt</span></span></code></pre></div><p><strong>Steps:</strong></p><ol><li>In the Rules editor, hold down <code>Command</code> (Mac) / <code>Ctrl</code> (Windows).</li><li>Click with the mouse on <code>resPrepend://temp/blank.txt</code>.</li><li>Enter the content to insert in the pop-up editing dialog.</li><li>Click <code>Save</code> to save.</li></ol><h2 id="parameter-details" tabindex="-1">Parameter Details <a class="header-anchor" href="#parameter-details" aria-label="Permalink to &quot;Parameter Details&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter</th><th style="text-align:left;">Required</th><th style="text-align:left;">Description &amp; Examples</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>pattern</strong></td><td style="text-align:left;">Yes</td><td style="text-align:left;">Expression used to match the request URL.<br>• Supports domains, paths, wildcards, regular expressions.<br>• See <a href="./pattern.html">Matching Pattern Documentation</a> for details.</td></tr><tr><td style="text-align:left;"><strong>value</strong></td><td style="text-align:left;">Yes</td><td style="text-align:left;">The response content to insert, supporting multiple formats:<br>• Local file path<br>• Remote URL<br>• Inline, embedded, Values references</td></tr><tr><td style="text-align:left;"><strong>lineProps</strong></td><td style="text-align:left;">No</td><td style="text-align:left;">Sets additional properties for the rule.<br>• Example: <code>lineProps://important</code> can increase this rule&#39;s priority.<br>• See <a href="./lineProps.html">lineProps Documentation</a> for details.</td></tr><tr><td style="text-align:left;"><strong>filters</strong></td><td style="text-align:left;">No</td><td style="text-align:left;">Optional filter conditions for precise control over when the rule takes effect.<br>• Can match request URL, method, headers, body content.<br>• Can match response status code, headers.<br>• See <a href="./filters.html">Filters Documentation</a> for details.</td></tr></tbody></table><h2 id="configuration-examples" tabindex="-1">Configuration Examples <a class="header-anchor" href="#configuration-examples" aria-label="Permalink to &quot;Configuration Examples&quot;">​</a></h2><h3 id="basic-examples" tabindex="-1">Basic Examples <a class="header-anchor" href="#basic-examples" aria-label="Permalink to &quot;Basic Examples&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Add a comment at the beginning of an HTML page</span></span>
<span class="line"><span>www.example.com/index.html resPrepend://(&lt;!--Page Start Time:--&gt;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Add a timestamp before a JSON response</span></span>
<span class="line"><span>api.example.com/data.json resPrepend://({&quot;timestamp&quot;:&quot;2024-01-01T00:00:00Z&quot;})</span></span></code></pre></div><h3 id="example-scenario-analysis" tabindex="-1">Example Scenario Analysis <a class="header-anchor" href="#example-scenario-analysis" aria-label="Permalink to &quot;Example Scenario Analysis&quot;">​</a></h3><h4 id="scenario-1-inserting-debug-information" tabindex="-1">Scenario 1: Inserting Debug Information <a class="header-anchor" href="#scenario-1-inserting-debug-information" aria-label="Permalink to &quot;Scenario 1: Inserting Debug Information&quot;">​</a></h4><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\`\`\` debug-header</span></span>
<span class="line"><span>&lt;!-- </span></span>
<span class="line"><span>  Debug Info:</span></span>
<span class="line"><span>  - URL: \${url}</span></span>
<span class="line"><span>  - Time: \${now}</span></span>
<span class="line"><span>  - User Agent: \${reqHeaders.user-agent}</span></span>
<span class="line"><span>--&gt;</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>www.example.com resPrepend://\`{debug-header}\`</span></span></code></pre></div><h4 id="scenario-2-adding-page-header-content" tabindex="-1">Scenario 2: Adding Page Header Content <a class="header-anchor" href="#scenario-2-adding-page-header-content" aria-label="Permalink to &quot;Scenario 2: Adding Page Header Content&quot;">​</a></h4><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Add a common header</span></span>
<span class="line"><span>^www.example.com/*.html resPrepend://{custom-html}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` custom-html</span></span>
<span class="line"><span>&lt;div class=&quot;site-header&quot;&gt;Website Header&lt;/div&gt;</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h4 id="scenario-3-injecting-analytics-script" tabindex="-1">Scenario 3: Injecting Analytics Script <a class="header-anchor" href="#scenario-3-injecting-analytics-script" aria-label="Permalink to &quot;Scenario 3: Injecting Analytics Script&quot;">​</a></h4><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Add Google Analytics script</span></span>
<span class="line"><span>www.example.com resPrepend://{google-analytics}</span></span>
<span class="line"><span>\`\`\` google-analytics</span></span>
<span class="line"><span>&lt;script async src=&quot;https://www.googletagmanager.com/gtag/js?id=UA-XXXXX&quot;&gt;&lt;/script&gt;</span></span>
<span class="line"><span>&lt;script&gt;</span></span>
<span class="line"><span>  window.dataLayer = window.dataLayer || [];</span></span>
<span class="line"><span>  function gtag(){dataLayer.push(arguments);}</span></span>
<span class="line"><span>  gtag(&#39;js&#39;, new Date());</span></span>
<span class="line"><span>  gtag(&#39;config&#39;, &#39;UA-XXXXX&#39;);</span></span>
<span class="line"><span>&lt;/script&gt;</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="using-with-other-protocols" tabindex="-1">Using with Other Protocols <a class="header-anchor" href="#using-with-other-protocols" aria-label="Permalink to &quot;Using with Other Protocols&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># First add header content, then add footer content</span></span>
<span class="line"><span>www.example.com/page resPrepend://(&lt;header&gt;) resAppend://(&lt;/footer&gt;)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Use with the file protocol</span></span>
<span class="line"><span>www.example.com/path resPrepend://(Hello) file://(-test-)</span></span></code></pre></div><p><strong>Response Result:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Hello-test-</span></span></code></pre></div><h3 id="using-embedded-values" tabindex="-1">Using Embedded Values <a class="header-anchor" href="#using-embedded-values" aria-label="Permalink to &quot;Using Embedded Values&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\`\`\` body.txt</span></span>
<span class="line"><span>Hello world.</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>www.example.com/path resPrepend://{body.txt} file://(-test-)</span></span></code></pre></div><p><strong>Response Result:</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Hello world.-test-</span></span></code></pre></div><h3 id="loading-from-a-file-or-remote-url" tabindex="-1">Loading from a File or Remote URL <a class="header-anchor" href="#loading-from-a-file-or-remote-url" aria-label="Permalink to &quot;Loading from a File or Remote URL&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Load from a local file</span></span>
<span class="line"><span>www.example.com/path1 resPrepend:///User/xxx/test.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Load from a remote URL</span></span>
<span class="line"><span>www.example.com/path2 resPrepend://https://www.xxx.com/xxx/params.txt</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Use a temporary file</span></span>
<span class="line"><span>www.example.com/path3 resPrepend://temp/blank.txt</span></span></code></pre></div><h3 id="using-with-filters" tabindex="-1">Using with Filters <a class="header-anchor" href="#using-with-filters" aria-label="Permalink to &quot;Using with Filters&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Add debug info only for development environment</span></span>
<span class="line"><span>www.example.com resPrepend://(&lt;!--Development Environment--&gt;) includeFilter://reqH:host=/dev\\./</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Add header only for HTML pages</span></span>
<span class="line"><span>www.example.com resPrepend://{header} resType://html</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` header</span></span>
<span class="line"><span>&lt;div class=&quot;header&quot; /&gt;</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Determine whether to add content based on response status code</span></span>
<span class="line"><span>www.example.com/api resPrepend://({&quot;debug&quot;:true}) includeFilter://s:200</span></span></code></pre></div><h2 id="advanced-usage" tabindex="-1">Advanced Usage <a class="header-anchor" href="#advanced-usage" aria-label="Permalink to &quot;Advanced Usage&quot;">​</a></h2><h3 id="dynamic-content-insertion" tabindex="-1">Dynamic Content Insertion <a class="header-anchor" href="#dynamic-content-insertion" aria-label="Permalink to &quot;Dynamic Content Insertion&quot;">​</a></h3><p>Use template strings to implement dynamic content:</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Insert current timestamp</span></span>
<span class="line"><span>www.example.com/api resPrepend://\`({&quot;timestamp&quot;:&quot;\${now}&quot;})\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Insert request information</span></span>
<span class="line"><span>www.example.com/debug resPrepend://\`{req-info}\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` req-info</span></span>
<span class="line"><span>&lt;!-- Request Method: \${method}, Path: \${path} --&gt;</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="combining-multiple-insertions" tabindex="-1">Combining Multiple Insertions <a class="header-anchor" href="#combining-multiple-insertions" aria-label="Permalink to &quot;Combining Multiple Insertions&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Insert multiple content fragments</span></span>
<span class="line"><span>www.example.com/page resPrepend://{header1} resPrepend://{header2}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` header1</span></span>
<span class="line"><span>&lt;div /&gt;</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span>\`\`\` header2</span></span>
<span class="line"><span>&lt;div id=&quot;header2&quot; /&gt;</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span># Final result: &lt;div id=&quot;header2&quot; /&gt;&lt;div id=&quot;header1&quot; /&gt;[Original Content]</span></span></code></pre></div><h3 id="conditional-insertion" tabindex="-1">Conditional Insertion <a class="header-anchor" href="#conditional-insertion" aria-label="Permalink to &quot;Conditional Insertion&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Insert content only under specific conditions</span></span>
<span class="line"><span>www.example.com/admin resPrepend://{log.js} includeFilter://reqH:cookie=/admin=true/</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\`\` log.js</span></span>
<span class="line"><span>&lt;script&gt;console.log(&#39;Admin Page&#39;)&lt;/script&gt;</span></span>
<span class="line"><span>\`\`\`\`</span></span></code></pre></div><h2 id="common-questions" tabindex="-1">Common Questions <a class="header-anchor" href="#common-questions" aria-label="Permalink to &quot;Common Questions&quot;">​</a></h2><h3 id="q-the-resprepend-rule-is-not-taking-effect" tabindex="-1">Q: The resPrepend rule is not taking effect. <a class="header-anchor" href="#q-the-resprepend-rule-is-not-taking-effect" aria-label="Permalink to &quot;Q: The resPrepend rule is not taking effect.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the response status code has a response body (excluding 204, 304, etc.).</li><li>Whether the rule pattern correctly matches the request URL.</li><li>Whether the filter conditions are met.</li><li>Whether other rules are interfering.</li></ol><h3 id="q-how-to-ensure-content-is-inserted-at-a-specific-position" tabindex="-1">Q: How to ensure content is inserted at a specific position? <a class="header-anchor" href="#q-how-to-ensure-content-is-inserted-at-a-specific-position" aria-label="Permalink to &quot;Q: How to ensure content is inserted at a specific position?&quot;">​</a></h3><p><strong>A:</strong></p><ul><li><code>resPrepend</code> always inserts content at the very beginning of the response.</li><li>If you need to insert at other positions, consider using <code>resReplace</code> with regular expression replacement.</li></ul><h3 id="q-can-i-delete-parts-of-the-original-response" tabindex="-1">Q: Can I delete parts of the original response? <a class="header-anchor" href="#q-can-i-delete-parts-of-the-original-response" aria-label="Permalink to &quot;Q: Can I delete parts of the original response?&quot;">​</a></h3><p><strong>A:</strong> No. <code>resPrepend</code> only adds content; it does not delete or modify the original content. If you need to delete content, use the <code>resBody</code> protocol.</p><h2 id="differences-from-resbody" tabindex="-1">Differences from resBody <a class="header-anchor" href="#differences-from-resbody" aria-label="Permalink to &quot;Differences from resBody&quot;">​</a></h2><p>The main distinction between the <code>resPrepend</code> protocol and the <a href="./resBody.html"><code>resBody</code></a> protocol lies in the processing method:</p><ul><li><strong><code>resPrepend</code></strong>: Inserts specified content <strong>before</strong> the original response content, preserving the original.</li><li><strong><code>resBody</code></strong>: <strong>Replaces</strong> the entire response content, without preserving the original.</li></ul><h2 id="related-protocols" tabindex="-1">Related Protocols <a class="header-anchor" href="#related-protocols" aria-label="Permalink to &quot;Related Protocols&quot;">​</a></h2><ol><li><strong>Replace response content</strong>: <a href="./resBody.html">resBody</a><ul><li>Completely replaces the response content, without preserving the original.</li></ul></li><li><strong>Append content after the response body</strong>: <a href="./resAppend.html">resAppend</a><ul><li>Adds content at the end of the response.</li></ul></li><li><strong>Replace request content</strong>: <a href="./reqBody.html">reqBody</a><ul><li>Replaces the request body content sent to the server.</li></ul></li><li><strong>Insert content before the request body</strong>: <a href="./reqPrepend.html">reqPrepend</a><ul><li>Inserts content before the request body.</li></ul></li><li><strong>Append content after the request body</strong>: <a href="./reqAppend.html">reqAppend</a><ul><li>Adds content at the end of the request body.</li></ul></li></ol><h2 id="further-reading" tabindex="-1">Further Reading <a class="header-anchor" href="#further-reading" aria-label="Permalink to &quot;Further Reading&quot;">​</a></h2><ul><li><a href="./pattern.html">Matching Pattern Documentation</a>: Learn more about URL matching rules.</li><li><a href="./operation.html">Operation Commands Documentation</a>: Learn about multiple ways to load content.</li><li><a href="./filters.html">Filters Documentation</a>: Learn more about filter functionalities.</li></ul>`,74)]))}const g=a(i,[["render",o]]);export{u as __pageData,g as default};
