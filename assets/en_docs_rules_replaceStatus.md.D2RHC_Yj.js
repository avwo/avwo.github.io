import{_ as a,c as t,o as s,ag as n}from"./chunks/framework.Bw-5EFTY.js";const u=JSON.parse('{"title":"replaceStatus","description":"","frontmatter":{},"headers":[],"relativePath":"en/docs/rules/replaceStatus.md","filePath":"en/docs/rules/replaceStatus.md"}'),i={name:"en/docs/rules/replaceStatus.md"};function o(l,e,r,c,p,d){return s(),t("div",null,e[0]||(e[0]=[n(`<h1 id="replacestatus" tabindex="-1">replaceStatus <a class="header-anchor" href="#replacestatus" aria-label="Permalink to &quot;replaceStatus&quot;">​</a></h1><p>The <code>replaceStatus</code> protocol is used to replace HTTP status codes. It changes the original status code to a specified HTTP status code after the request response is completed. Through the <code>replaceStatus</code> protocol, you can:</p><ul><li><strong>Modify the status code of server responses</strong>: Replace status codes based on real server responses.</li><li><strong>Test handling logic for different status codes</strong>: Test various status code scenarios without modifying backend code.</li><li><strong>Error scenario simulation</strong>: Convert normal responses to error status codes to test client fault tolerance.</li><li><strong>Redirect testing</strong>: Modify redirect status codes or targets.</li></ul><h2 id="rule-syntax" tabindex="-1">Rule Syntax <a class="header-anchor" href="#rule-syntax" aria-label="Permalink to &quot;Rule Syntax&quot;">​</a></h2><p>The <code>replaceStatus</code> protocol supports multiple configuration methods:</p><h3 id="_1-inline-value-direct-specification" tabindex="-1">1. Inline Value (Direct Specification) <a class="header-anchor" href="#_1-inline-value-direct-specification" aria-label="Permalink to &quot;1. Inline Value (Direct Specification)&quot;">​</a></h3><p>Write the status code to replace directly in the rule.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern replaceStatus://code [lineProps...] [filters...]</span></span></code></pre></div><p><strong>Example:</strong></p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>www.example.com/api/old replaceStatus://301</span></span></code></pre></div><h3 id="_2-embedded-value-using-code-block" tabindex="-1">2. Embedded Value (Using Code Block) <a class="header-anchor" href="#_2-embedded-value-using-code-block" aria-label="Permalink to &quot;2. Embedded Value (Using Code Block)&quot;">​</a></h3><p>Use this method when you need to return different status codes based on conditions or want to reuse configurations.</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern replaceStatus://{custom-key} [lineProps...] [filters...]</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` custom-key</span></span>
<span class="line"><span>404</span></span>
<span class="line"><span>\`\`\`</span></span></code></pre></div><h3 id="_3-referencing-a-value-from-the-values-panel" tabindex="-1">3. Referencing a Value from the Values Panel <a class="header-anchor" href="#_3-referencing-a-value-from-the-values-panel" aria-label="Permalink to &quot;3. Referencing a Value from the Values Panel&quot;">​</a></h3><p>Reference a status code pre-defined in the <code>Values</code> panel (central configuration area).</p><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>pattern replaceStatus://{key-of-values} [lineProps...] [filters...]</span></span></code></pre></div><p><strong>Prerequisite</strong>: A key named <code>key-of-values</code> with a status code as its value must exist in <code>Values</code>.</p><h3 id="_4-file-remote-url-loading" tabindex="-1">4. File/Remote URL Loading <a class="header-anchor" href="#_4-file-remote-url-loading" aria-label="Permalink to &quot;4. File/Remote URL Loading&quot;">​</a></h3><p><strong>Currently NOT supported</strong> to dynamically load content from local files or remote URLs.</p><h2 id="parameter-details" tabindex="-1">Parameter Details <a class="header-anchor" href="#parameter-details" aria-label="Permalink to &quot;Parameter Details&quot;">​</a></h2><table tabindex="0"><thead><tr><th style="text-align:left;">Parameter</th><th style="text-align:left;">Required</th><th style="text-align:left;">Description &amp; Examples</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>pattern</strong></td><td style="text-align:left;">Yes</td><td style="text-align:left;">Expression used to match the request URL.<br>• Supports domains, paths, wildcards, regular expressions.<br>• See <a href="./pattern.html">Matching Pattern Documentation</a> for details.</td></tr><tr><td style="text-align:left;"><strong>code</strong></td><td style="text-align:left;">Yes</td><td style="text-align:left;">The HTTP response status code to replace, such as:<br>• <code>200</code> OK<br>• <code>301</code> Permanent Redirect<br>• <code>302</code> Temporary Redirect<br>• <code>404</code> Not Found<br>• <code>500</code> Internal Server Error<br>• Supports all standard HTTP status codes.</td></tr><tr><td style="text-align:left;"><strong>lineProps</strong></td><td style="text-align:left;">No</td><td style="text-align:left;">Sets additional properties for the rule.<br>• Example: <code>lineProps://important</code> can increase this rule&#39;s priority.<br>• See <a href="./lineProps.html">lineProps Documentation</a> for details.</td></tr><tr><td style="text-align:left;"><strong>filters</strong></td><td style="text-align:left;">No</td><td style="text-align:left;">Optional filter conditions for precise control over when the rule takes effect.<br>• Can match request URL, method, headers, body content.<br>• Can match response status code, headers.<br>• See <a href="./filters.html">Filters Documentation</a> for details.</td></tr></tbody></table><h2 id="configuration-examples" tabindex="-1">Configuration Examples <a class="header-anchor" href="#configuration-examples" aria-label="Permalink to &quot;Configuration Examples&quot;">​</a></h2><h3 id="basic-examples" tabindex="-1">Basic Examples <a class="header-anchor" href="#basic-examples" aria-label="Permalink to &quot;Basic Examples&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Replace any response with 404 status code.</span></span>
<span class="line"><span>www.example.com replaceStatus://404</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Replace server errors with normal status codes.</span></span>
<span class="line"><span>www.example.com/api replaceStatus://200 includeFilter://s:500</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Modify redirect status codes.</span></span>
<span class="line"><span>www.example.com/redirect replaceStatus://307</span></span></code></pre></div><h3 id="simulating-authentication-failure" tabindex="-1">Simulating Authentication Failure <a class="header-anchor" href="#simulating-authentication-failure" aria-label="Permalink to &quot;Simulating Authentication Failure&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Replace normal responses with 401 status code, triggering browser authentication popup.</span></span>
<span class="line"><span>www.example.com/secure-page replaceStatus://401</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Disable the login dialog and directly return 401.</span></span>
<span class="line"><span>www.example.com/secure-page replaceStatus://401 disable://userLogin</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Or use lineProps to achieve the same effect.</span></span>
<span class="line"><span>www.example.com/secure-page replaceStatus://401 lineProps://disableUserLogin</span></span></code></pre></div><h3 id="conditional-replacement" tabindex="-1">Conditional Replacement <a class="header-anchor" href="#conditional-replacement" aria-label="Permalink to &quot;Conditional Replacement&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Replace only when the original status code is 200 with 500.</span></span>
<span class="line"><span>www.example.com/api replaceStatus://500 includeFilter://s:200</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Replace response status codes only for specific paths.</span></span>
<span class="line"><span>www.example.com/api/admin replaceStatus://403</span></span></code></pre></div><h3 id="combining-with-other-protocols" tabindex="-1">Combining with Other Protocols <a class="header-anchor" href="#combining-with-other-protocols" aria-label="Permalink to &quot;Combining with Other Protocols&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Replace status code and modify response content.</span></span>
<span class="line"><span>www.example.com/api/error replaceStatus://500 resBody://{errMsg}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>\`\`\` errMsg</span></span>
<span class="line"><span>{&quot;message&quot;:&quot;Custom error message&quot;}</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Replace with 301 redirect and set new Location header.</span></span>
<span class="line"><span>www.example.com/old-url replaceStatus://301 resHeaders://location=https://www.example.com/new-url</span></span></code></pre></div><h3 id="using-embedded-values" tabindex="-1">Using Embedded Values <a class="header-anchor" href="#using-embedded-values" aria-label="Permalink to &quot;Using Embedded Values&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>\`\`\` maintenance-status</span></span>
<span class="line"><span>503</span></span>
<span class="line"><span>\`\`\`</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Replace all website responses with maintenance status.</span></span>
<span class="line"><span>www.example.com replaceStatus://{maintenance-status}</span></span></code></pre></div><h3 id="environment-specific-configuration" tabindex="-1">Environment-Specific Configuration <a class="header-anchor" href="#environment-specific-configuration" aria-label="Permalink to &quot;Environment-Specific Configuration&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Simulate errors only in testing environment.</span></span>
<span class="line"><span>test.example.com/api replaceStatus://500</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Development environment remains unchanged.</span></span>
<span class="line"><span># dev.example.com/api (no replaceStatus set)</span></span></code></pre></div><h2 id="common-use-cases" tabindex="-1">Common Use Cases <a class="header-anchor" href="#common-use-cases" aria-label="Permalink to &quot;Common Use Cases&quot;">​</a></h2><h3 id="_1-error-handling-testing" tabindex="-1">1. Error Handling Testing <a class="header-anchor" href="#_1-error-handling-testing" aria-label="Permalink to &quot;1. Error Handling Testing&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Test client handling of server errors.</span></span>
<span class="line"><span>www.example.com/api replaceStatus://500 includeFilter://chance:0.1</span></span></code></pre></div><h3 id="_2-redirect-behavior-testing" tabindex="-1">2. Redirect Behavior Testing <a class="header-anchor" href="#_2-redirect-behavior-testing" aria-label="Permalink to &quot;2. Redirect Behavior Testing&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Test permanent redirect caching.</span></span>
<span class="line"><span>www.example.com/old-page replaceStatus://301</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Test temporary redirect.</span></span>
<span class="line"><span>www.example.com/temp-redirect replaceStatus://302</span></span></code></pre></div><h3 id="_3-authentication-and-authorization-testing" tabindex="-1">3. Authentication and Authorization Testing <a class="header-anchor" href="#_3-authentication-and-authorization-testing" aria-label="Permalink to &quot;3. Authentication and Authorization Testing&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Test unauthenticated access.</span></span>
<span class="line"><span>www.example.com/protected replaceStatus://401</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Test insufficient permissions.</span></span>
<span class="line"><span>www.example.com/admin replaceStatus://403</span></span></code></pre></div><h3 id="_4-rate-limiting-testing" tabindex="-1">4. Rate Limiting Testing <a class="header-anchor" href="#_4-rate-limiting-testing" aria-label="Permalink to &quot;4. Rate Limiting Testing&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Test too many requests scenarios.</span></span>
<span class="line"><span>www.example.com/api/rate-limited replaceStatus://429 resHeaders://retry-after=60</span></span></code></pre></div><h3 id="_5-maintenance-mode-testing" tabindex="-1">5. Maintenance Mode Testing <a class="header-anchor" href="#_5-maintenance-mode-testing" aria-label="Permalink to &quot;5. Maintenance Mode Testing&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Test maintenance page.</span></span>
<span class="line"><span>www.example.com replaceStatus://503 resBody://(&lt;h1&gt;System Under Maintenance...&lt;/h1&gt;)</span></span></code></pre></div><h2 id="differences-from-statuscode" tabindex="-1">Differences from statusCode <a class="header-anchor" href="#differences-from-statuscode" aria-label="Permalink to &quot;Differences from statusCode&quot;">​</a></h2><p>The main distinction between the <code>replaceStatus</code> protocol and the <a href="./statusCode.html"><code>statusCode</code></a> protocol lies in the processing timing:</p><ul><li><strong><code>replaceStatus</code></strong>: <strong>First requests the backend server</strong>, then replaces the status code after receiving the response.</li><li><strong><code>statusCode</code></strong>: <strong>Does not request the backend server</strong>, immediately returns the specified status code.</li></ul><h2 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-label="Permalink to &quot;Notes&quot;">​</a></h2><h3 id="_1-difference-from-statuscode" tabindex="-1">1. Difference from statusCode <a class="header-anchor" href="#_1-difference-from-statuscode" aria-label="Permalink to &quot;1. Difference from statusCode&quot;">​</a></h3><ul><li><strong>Processing timing</strong>: <code>replaceStatus</code> takes effect during the response stage, <code>statusCode</code> takes effect during the request stage.</li><li><strong>Server access</strong>: <code>replaceStatus</code> accesses the server, <code>statusCode</code> does not.</li><li><strong>Use cases</strong>: Use <code>replaceStatus</code> when real server data is needed, use <code>statusCode</code> for complete simulation.</li></ul><h3 id="_2-response-content-retention" tabindex="-1">2. Response Content Retention <a class="header-anchor" href="#_2-response-content-retention" aria-label="Permalink to &quot;2. Response Content Retention&quot;">​</a></h3><ul><li>By default, response content remains unchanged when replacing status codes.</li><li>Response content can be modified by combining with the <a href="./resBody.html"><code>resBody</code></a> protocol.</li></ul><h3 id="_3-authentication-popup-control" tabindex="-1">3. Authentication Popup Control <a class="header-anchor" href="#_3-authentication-popup-control" aria-label="Permalink to &quot;3. Authentication Popup Control&quot;">​</a></h3><ul><li>When replacing with <code>401</code> status code, the browser authentication popup is triggered by default.</li><li>You can disable the popup in the following ways: <ul><li>Add <code>disable://userLogin</code>.</li><li>Add <code>lineProps://disableUserLogin</code>.</li><li>Use the reverse configuration of the <a href="./enable.html"><code>enable</code></a> protocol.</li></ul></li></ul><h3 id="_4-redirect-handling" tabindex="-1">4. Redirect Handling <a class="header-anchor" href="#_4-redirect-handling" aria-label="Permalink to &quot;4. Redirect Handling&quot;">​</a></h3><ul><li>When replacing with redirect status codes (301, 302, etc.), you usually need to modify the <code>Location</code> response header accordingly.</li><li>Otherwise, the client may not handle the redirect correctly.</li></ul><h3 id="_5-status-code-compatibility" tabindex="-1">5. Status Code Compatibility <a class="header-anchor" href="#_5-status-code-compatibility" aria-label="Permalink to &quot;5. Status Code Compatibility&quot;">​</a></h3><ul><li>Ensure the replaced status code is compatible with the response content.</li><li>For example, an HTML page should not be replaced with a 204 (No Content) status code.</li></ul><h2 id="advanced-usage" tabindex="-1">Advanced Usage <a class="header-anchor" href="#advanced-usage" aria-label="Permalink to &quot;Advanced Usage&quot;">​</a></h2><h3 id="status-code-conversion-mapping" tabindex="-1">Status Code Conversion Mapping <a class="header-anchor" href="#status-code-conversion-mapping" aria-label="Permalink to &quot;Status Code Conversion Mapping&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Unify all redirects as 302.</span></span>
<span class="line"><span>www.example.com replaceStatus://302 includeFilter://s:301</span></span></code></pre></div><h3 id="probabilistic-replacement" tabindex="-1">Probabilistic Replacement <a class="header-anchor" href="#probabilistic-replacement" aria-label="Permalink to &quot;Probabilistic Replacement&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Replace responses with errors 10% of the time.</span></span>
<span class="line"><span>www.example.com/api replaceStatus://500 includeFilter://chance:0.1</span></span></code></pre></div><h3 id="combining-multiple-rules" tabindex="-1">Combining Multiple Rules <a class="header-anchor" href="#combining-multiple-rules" aria-label="Permalink to &quot;Combining Multiple Rules&quot;">​</a></h3><div class="language-txt vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span># Perform different replacements for different original status codes.</span></span>
<span class="line"><span>www.example.com/api replaceStatus://200 includeFilter://s:404</span></span>
<span class="line"><span>www.example.com/api replaceStatus://400 includeFilter://s:403</span></span></code></pre></div><h2 id="troubleshooting" tabindex="-1">Troubleshooting <a class="header-anchor" href="#troubleshooting" aria-label="Permalink to &quot;Troubleshooting&quot;">​</a></h2><h3 id="q-status-code-replacement-is-not-taking-effect" tabindex="-1">Q: Status code replacement is not taking effect. <a class="header-anchor" href="#q-status-code-replacement-is-not-taking-effect" aria-label="Permalink to &quot;Q: Status code replacement is not taking effect.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the rule pattern correctly matches the request URL.</li><li>Whether there are other higher-priority rules overriding it.</li><li>Whether the filter conditions are met (especially filtering on the original status code).</li></ol><h3 id="q-response-content-does-not-match-the-status-code" tabindex="-1">Q: Response content does not match the status code. <a class="header-anchor" href="#q-response-content-does-not-match-the-status-code" aria-label="Permalink to &quot;Q: Response content does not match the status code.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the response content is also modified.</li><li>Whether the response headers are compatible with the new status code.</li><li>Whether the client can correctly handle that status code.</li></ol><h3 id="q-browser-pops-up-authentication-window" tabindex="-1">Q: Browser pops up authentication window. <a class="header-anchor" href="#q-browser-pops-up-authentication-window" aria-label="Permalink to &quot;Q: Browser pops up authentication window.&quot;">​</a></h3><p><strong>A:</strong> For 401 status code:</p><ol><li>Check if <code>disable://userLogin</code> or <code>lineProps://disableUserLogin</code> is added.</li><li>Confirm if the rule order is correct.</li></ol><h3 id="q-redirect-loop" tabindex="-1">Q: Redirect loop. <a class="header-anchor" href="#q-redirect-loop" aria-label="Permalink to &quot;Q: Redirect loop.&quot;">​</a></h3><p><strong>A:</strong> Check:</p><ol><li>Whether the correct <code>Location</code> header is set.</li><li>Whether the redirect target is correct.</li><li>Whether multiple redirect rules conflict.</li></ol><h2 id="related-protocols" tabindex="-1">Related Protocols <a class="header-anchor" href="#related-protocols" aria-label="Permalink to &quot;Related Protocols&quot;">​</a></h2><ol><li><strong>Directly return status code</strong>: <a href="./statusCode.html">statusCode</a><ul><li>Does not request the server, directly returns the specified status code.</li></ul></li><li><strong>Disable authentication popup</strong>: <a href="./disable.html">disable</a> or <a href="./lineProps.html">lineProps</a><ul><li>Disable the browser login popup triggered by 401 status code.</li></ul></li><li><strong>Set response content</strong>: <a href="./resBody.html">resBody</a><ul><li>Add custom content for status code responses.</li></ul></li><li><strong>Set response headers</strong>: <a href="./resHeaders.html">resHeaders</a><ul><li>Set necessary response headers for scenarios like redirects.</li></ul></li></ol><h2 id="further-reading" tabindex="-1">Further Reading <a class="header-anchor" href="#further-reading" aria-label="Permalink to &quot;Further Reading&quot;">​</a></h2><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status" target="_blank" rel="noreferrer">HTTP Status Codes MDN Documentation</a>: Learn the meaning of all HTTP status codes.</li><li><a href="./pattern.html">Matching Pattern Documentation</a>: Learn more about URL matching rules.</li><li><a href="./filters.html">Filters Documentation</a>: Learn more about filter functionalities.</li></ul>`,83)]))}const g=a(i,[["render",o]]);export{u as __pageData,g as default};
